---
aliases:
  - ACM
tags:
  - ACM
date: 2025-11-18T13:01:00
---
**题目链接：**[P10655 [ROI 2017] 反物质 (Day 2) - 洛谷](https://www.luogu.com.cn/problem/P10655)

**思路：**
首先列出dp状态和转移方程

由于需要考虑反物质不能超过容量$a$，正着dp比较麻烦，所以可以倒着来，用类似期望dp的方式。

设 $f_i$ 代表当容器内反物质有 $i$ 个时，通过后续操作能得到的最大金钱数，则转移方程为：

$$
f_i=\max(\underset{1\leq j\leq n,i+r_j\leq a}\max(\underset{l_j\leq t\leq r_j}\min(f_t)-c_j),1e9\cdot i)
$$
发现瓶颈在对一个区间取$\min$，如果直接朴素统计是$\mathcal{O}(na^2)$的，考虑优化，比较好想的就是用单调队列维护$n$个区间的最小值，但是发现空间会被卡到$\mathcal{O}(na)$，爆了

考虑优先队列的运行流程，总是从左边取一个值放入队首，然后删掉队尾大于队首元素的元素，并检查队尾元素是否超过了区间的约束





**​代码：**

```cpp

```
